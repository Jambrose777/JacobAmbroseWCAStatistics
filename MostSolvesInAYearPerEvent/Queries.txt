SELECT  CONCAT('[', personName, '](https://www.worldcubeassociation.org/persons/', personId, ')') person,
	RIGHT(competitionId, 4) AS year,
	COUNT(value1>0 OR null) +
    COUNT(value2>0 OR null) +
    COUNT(value3>0 OR null) +
    COUNT(value4>0 OR null) +
    COUNT(value5>0 OR null) solves,
    COUNT(value1 AND value1<>-2 OR null)+
    COUNT(value2 AND value2<>-2 OR null)+
    COUNT(value3 AND value3<>-2 OR null)+
    COUNT(value4 AND value4<>-2 OR null)+
    COUNT(value5 AND value5<>-2 OR null)attempts
FROM Results
WHERE eventId = '333'
GROUP BY personId, year
ORDER BY solves DESC, attempts LIMIT 10;
